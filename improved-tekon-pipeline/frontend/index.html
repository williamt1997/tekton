<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style/style.css" />
    <script src="index.js" defer></script>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon.ico" />
    <link href="https://www.dafontfree.net/embed/Y29vcGVyLWJsYWNrLXJlZ3VsYXImZGF0YS8yNC9jLzExOTYxOC9DT09QQkwudHRm" rel="stylesheet" type="text/css" />
    <title>Homers's Web Page</title>
    <script src="config.js"></script>
    <script>
        window.URL = "%URL%";
        async function addView() {
            try {
                const response = await fetch((window.APP_CONFIG.URL + "/add"), {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });
                if (!response.ok) {
                    throw new Error("DOH");
                }
            } catch (error) {
                console.error("DOH");
            }
        }

        async function getViews() {
    try {
        const response = await fetch(window.APP_CONFIG.URL + "/get", {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
            },
        });

        if (!response.ok) {
            throw new Error("API request failed");
        }

        const text = await response.text(); // Read response as text
        console.log("API Response:", text); // Debugging log

        const viewCount = parseInt(text, 10); // Convert to integer

        if (!isNaN(viewCount)) {
            document.getElementById("viewsCount").textContent = `Views: ${viewCount}`;
        } else {
            console.error("Error: Unable to parse response as a number");
            document.getElementById("viewsCount").textContent = "Views: N/A";
        }
    } catch (error) {
        console.error("Error fetching views:", error);
        document.getElementById("viewsCount").textContent = "Views: Error";
    }
}

        function displayViews(viewCount) {
            const viewsElement = document.getElementById('viewsCount');
            viewsElement.textContent = `Views: ${viewCount}`; // Display the views on the page
        }

        window.onload = async () => {
            await addView(); // Call addView on page load
            await getViews(); // Call getViews on page load
        };
    </script>
</head>
<body>
    <div class="cortina-izq cortina">
        <img src="assets/izq.png" alt="" class="" />
    </div>

    <h1 class="title">Homer's Web Page</h1>
    
    <div class="parent">
        <div class="div1"><img src="assets/jesus.gif" width="270px" /></div>
        <div class="div2"><img src="assets/reloj.gif" width="80px" /></div>
        <div class="div3"><img src="assets/worm.gif" width="100px" /></div>
        <div class="div4"><img src="assets/toaster.gif" width="90px" /></div>
        <div class="div5"><img src="assets/mouth.gif" width="130px" /></div>
        <div class="div6"><img src="assets/toaster.gif" width="125px" /></div>
        <div class="div7"><img src="assets/ring.gif" width="70px" /></div>
        <div class="div8"><img src="assets/reloj.gif" width="120px" /></div>
        <div class="div9"><img src="assets/worm.gif" width="100px" /></div>
        <div class="div10"><img src="assets/reloj.gif" width="70px" /></div>
        <div class="div11"><img src="assets/mouth.gif" width="120px" /></div>
        <div class="div12"><img src="assets/ring.gif" width="100px" /></div>
        <div class="div13"><img src="assets/mouth.gif" width="130px" /></div>
        <div class="div14"><img src="assets/worm.gif" width="100px" /></div>
        <div class="div15"><img src="assets/toaster.gif" width="70px" /></div>
    </div>

    <div class="parent-mobile">
        <section>
            <div class="div2-mobile div-mobile"><img src="assets/reloj.gif" /></div>
            <div class="div3-mobile div-mobile"><img src="assets/mouth.gif" /></div>
            <div class="div4-mobile div-mobile"><img src="assets/ring.gif" /></div>
            <div class="div5-mobile div-mobile"><img src="assets/worm.gif" /></div>
            <div class="div6-mobile div-mobile"><img src="assets/mouth.gif" /></div>
        </section>
        <section>
            <div class="div1-mobile div-mobile"><img src="assets/jesus.gif" /></div>
        </section>
        <section>
            <div class="div7-mobile div-mobile"><img src="assets/reloj.gif" /></div>
            <div class="div8-mobile div-mobile"><img src="assets/ring.gif" /></div>
            <div class="div9-mobile div-mobile"><img src="assets/toaster.gif" /></div>
            <div class="div10-mobile div-mobile"><img src="assets/worm.gif" /></div>
            <div class="div11-mobile div-mobile"><img src="assets/ring.gif" /></div>
        </section>
    </div>

    <div id="viewsContainer">
        <div id="viewsCount">Views: 0</div>
    </div>

    <div class="cortina-der cortina">
        <img src="assets/der.png" alt="" />
    </div>
</body>
</html>

